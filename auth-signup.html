<!doctype html>
<html lang="en" data-layout="vertical" data-topbar="light" data-sidebar="dark" data-sidebar-size="lg" data-sidebar-image="none" data-preloader="disable">
<head>

    <meta charset="utf-8" />
    <title>TechMark</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
    <meta content="Themesbrand" name="author" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="images/icn.png">

    <!-- Layout config Js -->
    <script src="assets-main/js/layout.js"></script>
    <!-- Bootstrap Css -->
    <link href="assets-main/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="assets-main/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="assets-main/css/app.min.css" rel="stylesheet" type="text/css" />
    <!-- custom Css-->
    <link href="assets-main/css/custom.min.css" rel="stylesheet" type="text/css" />

</head>

<body>

    <div class="auth-page-wrapper pt-5">
        <!-- auth page bg -->
        <div class="auth-one-bg-position auth-one-bg" id="auth-particles">
            <div class="bg-overlay"></div>

            <div class="shape">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1440 120">
                    <path d="M 0,36 C 144,53.6 432,123.2 720,124 C 1008,124.8 1296,56.8 1440,40L1440 140L0 140z"></path>
                </svg>
            </div>
        </div>

        <!-- auth page content -->
        <div class="auth-page-content">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-center mt-sm-5 mb-4 text-white-50">
                            <div>
                                <a href="index.html" class="d-inline-block auth-logo">
                                    <img src="images/logo-2.png" alt="" height="40">
                                </a>
                            </div>
                            <p class="mt-3 fs-15 fw-medium"></p>
                        </div>
                    </div>
                </div>
                <!-- end row -->

                <div class="row justify-content-center">
                    <div class="col-md-8 col-lg-6 col-xl-5">
                        <div class="card mt-4">
                            <div class="card-body p-4">
                                <div class="text-center mt-2">
                                    <h5 class="text-primary">Create New Account</h5>
                                    <p class="text-muted">Get your free TechMark account now</p>
                                </div>
                                <div class="p-2 mt-4" id="signUp">
                                    <form class="needs-validation" onSubmit="signUp(event)">
                                        <div class="mb-3">
                                            <label for="companyName" class="form-label">Company Name<span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="companyName" placeholder="Enter Name of company" required>
                                            <div class="invalid-feedback">
                                                Please enter company name
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="fullName" class="form-label">Full Name<span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="fullName" placeholder="Enter Your Full Name" required>
                                            <div class="invalid-feedback">
                                                Please enter Full Name
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="businessemail" class="form-label">Business Email <span class="text-danger">*</span></label>
                                            <input type="email" class="form-control" id="businessemail" placeholder="Enter business email address" required>
                                            <div class="invalid-feedback">
                                                Please enter Business email
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="contactNumber" class="form-label">Contact Number<span class="text-danger">*</span></label>
                                            <input type="number" class="form-control" id="contactNumber" placeholder="Enter contact number" required>
                                            <div class="invalid-feedback">
                                                Please enter contact number
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label" for="password-input">Password</label>
                                            <div class="position-relative auth-pass-inputgroup">
                                                <input type="password" class="form-control pe-5 password-input" onpaste="return false" placeholder="Enter password" id="password-input" aria-describedby="passwordInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" required>
                                                <button class="btn btn-link position-absolute end-0 top-0 text-decoration-none text-muted password-addon" type="button" id="password-addon"><i class="ri-eye-fill align-middle"></i></button>
                                                <div class="invalid-feedback">
                                                    Please enter password
                                                </div>
                                            </div>
                                        </div>
                                        <div id="password-contain" class="p-3 bg-light mb-2 rounded">
                                            <h5 class="fs-13">Password must contain:</h5>
                                            <p id="pass-length" class="invalid fs-12 mb-2">Minimum <b>8 characters</b></p>
                                            <p id="pass-lower" class="invalid fs-12 mb-2">At <b>lowercase</b> letter (a-z)</p>
                                            <p id="pass-upper" class="invalid fs-12 mb-2">At least <b>uppercase</b> letter (A-Z)</p>
                                            <p id="pass-number" class="invalid fs-12 mb-0">A least <b>number</b> (0-9)</p>
                                        </div>
                                        <div class="mb-4">
                                            <p class="mb-0 fs-12 text-muted fst-italic">By registering you agree to the TechMark <a href="#" class="text-primary text-decoration-underline fst-normal fw-medium">Terms of Use</a></p>
                                        </div>
                                        <div class="mt-4">
                                            <button class="btn btn-success w-100" type="submit">Sign Up</button>
                                        </div>
                                        <!--
                                            <div class="mt-4 text-center">
                                                <div class="signin-other-title">
                                                    <h5 class="fs-13 mb-4 title text-muted">Create account with</h5>
                                                </div>
                                                <div>
                                                    <button type="button" class="btn btn-primary btn-icon waves-effect waves-light"><i class="ri-facebook-fill fs-16"></i></button>
                                                    <button type="button" class="btn btn-danger btn-icon waves-effect waves-light"><i class="ri-google-fill fs-16"></i></button>
                                                    <button type="button" class="btn btn-dark btn-icon waves-effect waves-light"><i class="ri-github-fill fs-16"></i></button>
                                                    <button type="button" class="btn btn-info btn-icon waves-effect waves-light"><i class="ri-twitter-fill fs-16"></i></button>
                                                </div>
                                            </div>
                                        -->
                                    </form>
                                </div>
                            </div>
                            <!-- end card body -->
                        </div>
                        <!-- end card -->

                        <div class="mt-4 text-center">
                            <p class="mb-0">Already have an account ? <a href="auth-signin.html" class="fw-semibold text-primary text-decoration-underline"> Signin </a> </p>
                        </div>
                    </div>
                </div>
                <!-- end row -->
            </div>
            <!-- end container -->
        </div>
        <!-- end auth page content -->

        <!-- footer -->
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="text-center">
                            <p class="mb-0 text-muted">&copy;
                                <script>document.write(new Date().getFullYear())</script> TechMark. Designed<i class="mdi mdi-heart text-danger"></i> by LSIT Development
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- end Footer -->
    </div>
    <!-- end auth-page-wrapper -->

    <script>
        function generateOTP() { 
          // Declare a string variable  
          // which stores all string 
          var string = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; 
          let OTP = ''; 
          // Find the length of string 
          var len = string.length; 
          for (let i = 0; i < 6; i++ ) { 
              OTP += string[Math.floor(Math.random() * len)]; 
          } 
          return OTP; 
        } 
        var userData;
        var secret_code;
        function sendOTP(){
            secret_code = generateOTP();
            var content = "Dear "+ userData["fullName"] +",\n\nYour OTP is "+ secret_code +"\nDo not share it with anyone by any means.\nCode is only valid for 5 minutes\n\nRegards,\nTechMark Team"
            fetch('https://qntkvgkyo9.execute-api.us-east-1.amazonaws.com/techmark-otp/',
            {
                method: "POST",
                body: JSON.stringify({
                    "to": userData["businessemail"],
                    "subject": "Verify your Email for TechMark",
                    "content": content
                })
            }).then(response => {
                alert("OTP sent on "+ userData["businessemail"])
            }).then(data => {
                //handle data
                //console.log(data);
            }).catch(error => {
                //handle error
                console.log(error)
            });
        }

        function signUp(event){
            // Create a new Date object
            var currentDate = new Date();
            // Get individual components of the date and time
            var year = currentDate.getFullYear();
            var month = (currentDate.getMonth() + 1).toString().padStart(2, '0'); // Zero-padding the month
            var day = currentDate.getDate().toString().padStart(2, '0'); // Zero-padding the day
            var hours = currentDate.getHours().toString().padStart(2, '0'); // Zero-padding the hours
            var minutes = currentDate.getMinutes().toString().padStart(2, '0'); // Zero-padding the minutes
            var seconds = currentDate.getSeconds().toString().padStart(2, '0'); // Zero-padding the seconds
            userData = {
                "companyName": document.getElementById("companyName").value,
                "fullName": document.getElementById("fullName").value,
                "businessemail": document.getElementById("businessemail").value,
                "contactNumber": document.getElementById("contactNumber").value,
                "signupDate": `${year}-${month}-${day}`,
                "signupTime": `${hours}-${minutes}-${seconds}`,
                "password-input": btoa(unescape(encodeURIComponent(document.getElementById("password-input").value))) 
            }
            document.getElementById("signUp").innerHTML = 
                    `<form class="needs-validation" onsubmit="verifyOTP();return false">
                        <div class="mb-3">
                            <label for="otp" class="form-label">Enter Your OTP<span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="otp" placeholder="Enter OTP" required>
                            <div class="invalid-feedback">
                                Please enter OTP
                            </div>
                        </div>
                        <h6 onclick="sendOTP()">Resend OTP</h6>
                        <div class="mt-4">
                            <button class="btn btn-success w-100" type="submit">Verify</button>
                            <h6 id="otpStatus"></h6>
                        </div>
                    </form>`;
                    sendOTP()
        }

        function aws_config(){
            AWS.config.update(
                {
                    region: "us-east-1",/*endpoint: "http://localhost:8000",*/
                    accessKeyId: ("APGAJBXVL3W76N4WAIKA").split('').reverse().join(''),
                    secretAccessKey: ("OLQp/1824pRicifOpOmQS5gb0Vzz/l9WhnnL43YK").split('').reverse().join('')
                });
        }

        function verifyOTP(){
            if(document.getElementById("otp").value == secret_code){
                aws_config()
                var s3 = new AWS.S3();
                var params = {
                    Body: JSON.stringify(userData),
                    Bucket: "techmark-mail",
                    Key: `${userData["businessemail"]}/userAuth.json`,
                    ServerSideEncryption: "AES256", 
                    StorageClass: "STANDARD_IA"
                };

                s3.putObject(params, function(err, data) {
                    if(err){
                        //console.log(err, err.stack); // an error occurred
                        alert("Network Problem! Try After Sometime")
                    }else{
                        document.getElementById("otpStatus").innerHTML = "Account Created Successfully"
                        alert("Account Created Successfully");
                        location = "index.html";
                    }   
                });
            }else{
                document.getElementById("otpStatus").innerHTML = "Incorrect OTP"
            }
        }
    </script>

    <!-- JAVASCRIPT -->
    <script src="assets-main/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets-main/libs/simplebar/simplebar.min.js"></script>
    <script src="assets-main/libs/node-waves/waves.min.js"></script>
    <script src="assets-main/libs/feather-icons/feather.min.js"></script>
    <script src="assets-main/js/pages/plugins/lord-icon-2.1.0.js"></script>
    <script src="assets-main/js/plugins.js"></script>

    <!-- particles js -->
    <script src="assets-main/libs/particles.js/particles.js"></script>
    <!-- particles app js -->
    <script src="assets-main/js/pages/particles.app.js"></script>
    <!-- validation init -->
    <script src="assets-main/js/pages/form-validation.init.js"></script>
    <!-- password create init -->
    <script src="assets-main/js/pages/passowrd-create.init.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1.12.min.js"></script>
</body>
</html>